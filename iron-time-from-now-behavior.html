<!doctype html>
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../moment-element/moment-import.html">

<script>
var Polymer = Polymer || {};

/**
 * Default localization (en-US). Custom the localization via:
 * `Object.assign(Polymer.IronTimeFromNowBehaviorDefaultI18n, { today: 'Heute' });`
 */
Polymer.IronTimeFromNowBehaviorDefaultI18n = {
    today: 'Today',
    yesterday: 'Yesterday',
    week: 'This week',
    month: 'This month',
    recent_months: function(date) { return date.format('MMMM YYYY'); },
    year: 'This year',
    earlier: 'Earlier'
};

/**
 * Provides method to formas date/time to brackets like today, yesterday, this week.
 *
 * The output will be localized by the [momentjs](http://momentjs.com) library.
 *
 * @polymerBehavior Polymer.PaperDatePickerItemBehavior
 * @demo demo/index.html
 */
Polymer.IronTimeFromNowBehavior = {

	/**
	 * Returns a text describing the difference between now and the date
	 */
	fromNow: function(rawDate, i18n) {
		return this._fromNow(rawDate, new Date(), i18n);
	},

	/**
	 * For testing
	 */
	_fromNow: function(rawDate, rawNow, i18n) {
        i18n = i18n || Polymer.IronTimeFromNowBehaviorDefaultI18n;

		var date = moment(rawDate);
		var now = moment(rawNow);

		if (date.isSame(now, 'day')) {
			return i18n.today;
		}
		if (now.diff(date, 'day') < 2) {
			return i18n.yesterday;
		}
		if (date.isSame(now, 'week')) {
			return i18n.week;
		}
		if (date.isSame(now, 'month')) {
			return i18n.month;
		}
		if (now.diff(date, 'month') <= 9) {
			return i18n.recent_months(date);
		}
		if (date.isSame(now, 'year')) {
			return i18n.year;
		}

		return i18n.earlier;
	}
};

</script>
